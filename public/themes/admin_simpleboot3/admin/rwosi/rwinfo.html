<include file="public@header" />

<style>
	*{
		margin:0;
		padding:0;
	}
	.box{
		width:760px;
		height:350px;
		background:#fff;
		margin:27px ;
	}
	.box .head span{
		font-size:18px;
		color:#333;
	}
	.box .head{
		margin-bottom:20px;
	}
	.box .head a{
		text-decoration:none;
		float:right;
		font-size:15px;
		color:#333;
	}
	.box .head a:hover{
		color:#F00;
	}
	.box ul li{
		width:160px;
		height:150px;
		list-style:none;
		position:relative;
		float:left;
		margin-left:20px;
		margin-bottom:20px;
		overflow:hidden;
	}
	.box ul li .deatil{
		width:160px;
		height:240px;
		background:rgba(0,0,0,0.7);
		position:absolute;
		top:-240px;
		-webkit-transition:all 0.3s ease;<!--适应ie，谷歌，苹果浏览器内核-->
	-o-transition:all 0.3s ease;<!--适应Opera浏览器内核-->
	-moz-transition:all 0.3s ease;<!--火狐浏览器-->
	-ms-transition:all 0.3s ease;<!--微软-->
	}

	.box ul li .deatil h2{
		font-size:18px;
		color:#fff;
		text-align:center;
		padding-top:30px;
	}
	.box ul li .deatil p{
		font-size:16px;
		text-align:center;
		margin:30px;
		color:#fff;
	}
	.box ul li .deatil a{
		font-size:15px;
		display:block;
		color:#fff;
		background-color:#F00;
		text-decoration:none;
		width:100px;
		height:40px;
		text-align:center;
		line-height:40px;
		margin:0 auto;
	}
	.box ul li:hover .deatil{
		top:0;
	}
.xj{
	color: #ff0000;
}
</style>
<link rel="stylesheet" type="text/css" href="__STATIC__/css/Calendar.css" />
</head>
<body>
	<div class="wrap">
		<ul class="nav nav-tabs">
			<li><a href="{:url('rwosi/rwlist')}">任务管理</a></li>
			<!--<li class="active"><a href="{:url('xmosi/xmadd')}">添加</a></li>-->
		</ul>
		<form method="post" class="form-horizontal js-ajax-form margin-top-20" action="{:url('rwosi/addpost')}">
			<div class="form-group">
				<label for="input-user_login" class="col-sm-2 control-label" style="padding-top: 0"><span class="form-required">*</span>任务名称:</label>
					{$user.taskname}
			</div>
			<div class="form-group">
				<label for="input-user_login" class="col-sm-2 control-label" style="padding-top: 0"><span class="form-required">*</span>任务责任人:</label>
					{$user.taskcharge}
			</div>

			<div class="form-group">
				<label for="input-user_login" class="col-sm-2 control-label" style="padding-top: 0"><span class="form-required">*</span>计划名称:</label>
					{$user.planname}
			</div>
			<div class="form-group">
				<label for="input-user_login" class="col-sm-2 control-label" style="padding-top: 0"><span class="form-required">*</span>计划日期:</label>
				{$user.jhid}
			</div>
			<!--<div class="form-group">-->
				<!--<label for="input-user_login" class="col-sm-2 control-label" style="padding-top: 0"><span class="form-required">*</span>计划执行时间:</label>-->
				<!--&lt;!&ndash;<div class="col-md-6 col-sm-10">&ndash;&gt;-->
					<!--&lt;!&ndash;<textarea type="text" class="form-control" style="height: 150px" id="input-remark" >{$user.jhtime}</textarea>&ndash;&gt;-->
				<!--&lt;!&ndash;</div>&ndash;&gt;-->
				<!--{$user.jhtime}-->
			<!--</div>-->
			<!--<div class="box">-->
				<div class="mui-content">
					<div class="duty-list">
						<div id="calendar" style="width: 800px;left: 50px;"></div>
					</div>
					</div>
			<!--</div>-->


			<!--<div class="form-group">-->
				<!--<label for="input-user_login" class="col-sm-2 control-label" style="padding-top: 0"><span class="form-required">*</span>执行时间轴:</label>-->
				<!--<a class="btn btn-default" href="{:url('rwosi/timeshow',array('id'=>$user['id']))}">时间轴展示</a>-->
			<!--</div>-->
			<div style="overflow-x: auto; overflow-y: auto; height: 300px; width:70%;left: 50px " class="col-sm-2 control-label" >
				<table class="table table-hover table-bordered">
					<thead>
					<tr id="trlist">
						<th width="20">项目名称</th>
						<th width="30">项目内容</th>
						<th width="40" align="left">项目类型</th>
						<th width="40" align="left">操作</th>
					</tr>
					</thead>
					<tbody>
					<foreach name="xmlist" item="vo">
						<tr class="tdlist">
							<td>{$vo.itemname}</td>
							<td>{$vo.iteminfo}</td>
							<td>{$vo.itemtype}</td>
							<td><a class="btn btn-xs btn-primary xq" id="xq" onclick='xq("{$vo.itemid}")'>详情</a>
								<!--<a class="btn btn-xs btn-primary" href="{:url('rwosi/dtinfo',array('id'=>$vo['id']))}">巡检位置</a>-->
							</td>
						</tr>
					</foreach>
					</tbody>

				</table>
			</div>
			<div class="form-group">
				<div class="col-sm-offset-2 col-sm-10">
					<a class="btn btn-default" href="javascript:history.back(-1);">{:lang('BACK')}</a>
				</div>
			</div>
		</form>
		<form method="post" action="{:url('rwosi/rwgetiteminfo')}" id="xqform">
			<input type="hidden" name="times" id="times" >
			<input type="hidden" name="itemid" id="itemid" >
		</form>
	</div>
	<script src="__STATIC__/js/admin.js"></script>
<script>
//	$(function(){
//		$(".jhtimes").bind('click',function(i){
//			var html=$(this).html();
//			if($(".xzsj").text()!=''){
//				if($(".xzsj").text()!=html){
//					$(".xzsj").remove();
//					var str='<th width="40" align="left" class="xzsj">选择时间</th>';
//					$("#trlist").find('th').eq(2).after(str)
//				}
//			}else{
//				var str='<th width="40" align="left" class="xzsj">选择时间</th>';
//				$("#trlist").find('th').eq(2).after(str)
//			}
//			$(".tdlist").each(function(i){
//				if($(".xzsj1").text()!=''){
//					if($(".xzsj1").eq(i).text()!=html){
//						if($(".xzsj1").eq(0).text()!=html){
//							$(".xzsj1").remove();
//						}
//						var str1='<td class="xzsj1">'+html+'</td>';
//						$(this).find('td').eq(2).after(str1)
//					}
//				}else{
//				var str1='<td class="xzsj1">'+html+'</td>';
//				$(this).find('td').eq(2).after(str1)
//			}
//				var a=$(".xzsj1").eq(0).text();
//				$("#times").val(a);
//			});
//		})
//	});
	function xq(i){
		if($("#times").val()==''){
			alert("请选择执行日期");
			return false;
		}
		$("#itemid").val(i);
		$("#xqform").submit();
//		$.ajax({
//			url: "{:url('rwosi/rwgetiteminfo')}",
//			type: 'post',
//			async: false,
//			data: 'itemid='+i+'&time='+$("#times").val(),
//			success: function (data) {
//			}
//
//		});
	}
</script>
	<script src="__STATIC__/js/rljs/jquery.min.js"></script>
	<script src="__STATIC__/js/rljs/calendar.js"></script>
<script>
	var jsontime = '{$jsontime}';

	var data =eval(jsontime);
	console.log(data);
	$("#calendar").calendar({
		data: data,
		mode: "month",
		maxEvent: 5,
		showModeBtn: false,
		//  newDate: "2018-04-1",
		cellClick: function(events) {
			var html=events[0]['startDate'];
			if($(".xzsj").text()!=''){
				if($(".xzsj").text()!=html){
					$(".xzsj").remove();
					var str='<th width="40" align="left" class="xzsj">选择时间</th>';
					$("#trlist").find('th').eq(2).after(str)
				}
			}else{
				var str='<th width="40" align="left" class="xzsj">选择时间</th>';
				$("#trlist").find('th').eq(2).after(str)
			}
			$(".tdlist").each(function(i){
				if($(".xzsj1").text()!=''){
					if($(".xzsj1").eq(i).text()!=html){
						if($(".xzsj1").eq(0).text()!=html){
							$(".xzsj1").remove();
						}
						var str1='<td class="xzsj1">'+html+'</td>';
						$(this).find('td').eq(2).after(str1)
					}
				}else{
					var str1='<td class="xzsj1">'+html+'</td>';
					$(this).find('td').eq(2).after(str1)
				}
				var a=$(".xzsj1").eq(0).text();
				$("#times").val(a);
			});
			//viewCell的事件列表
			console.log(events[0]['startDate']);
//			alert(events);
		}
	})
</script>
</body>
</html>