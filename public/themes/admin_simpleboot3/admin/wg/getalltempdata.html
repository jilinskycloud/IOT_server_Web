<include file="public@header" />
</head>
<body>
	<div class="wrap js-check-wrap">
		<ul class="nav nav-tabs">
			<li class="active"><a href="{:url('wg/getalltempdata')}">传感器列表</a></li>
		</ul>
		<form class="well form-inline margin-top-20" method="get" action="{:url('wg/getalltempdata')}">
			网关序列号:
			<input type="text" class="form-control" name="gw_id" value="{$data_gw_id}"  style="width: 150px;" placeholder="网关序列号">
			<input type="text" class="form-control" name="sn_id" value="{$data_sn_id}"  style="width: 150px;" placeholder="传感器ID">
			<input type="text" class="layui-input form-control" name="select_start_time" id="test1"  value="{:input('request.select_start_time/s','')}" placeholder="请选择开始时间" style=" width:300px" autocomplete="off">
			~
			<input type="text" class="layui-input form-control" name="select_end_time" id="test2"  value="{:input('request.select_end_time/s','')}" placeholder="请选择结束时间" style=" width:300px" autocomplete="off">
			<input type="submit" id="search" class="btn btn-primary" value="搜索"/>
			<a class="btn btn-danger" href="{:url('getalltempdata')}">清空</a>
			<span class="btn btn-danger tempdata_del">删除条件数据</span>
		</form>
		<form action="{:url('Rbac/listorders')}" method="post" class="margin-top-20">
			<table class="table table-hover table-bordered">
				<thead>
					<tr>
						<th width="20">ID</th>
						<th align="left">网管序列号</th>
						<th align="left">传感器id</th>
						<th  align="left">类型</th>
						<th  align="left">发送ip</th>
						<th  align="left">数值</th>
						<th align="left">发送时间</th>
					</tr>
				</thead>
				<tbody>
					<foreach name="data" item="vo">
					<tr>
						<td>{$vo.id}</td>
						<td>{$vo.gw_id}</td>
						<td>{$vo.sn_id}</td>
						<td>{$vo.ST}</td>
						<td>
							{$vo.ip}
						</td>
						<td>{$vo.temp}</td>
						<td>{$vo.create_time}</td>
					</tr>
					</foreach>
				</tbody>
			</table>
			<div class="footer">
				<div class="pagination">{$page|default=''}</div>
			</div>
		</form>
	</div>
	<script src="__STATIC__/js/admin.js"></script>
	<script type="text/javascript">
		//隔5秒刷新当前页面
		// setInterval(window.location.reload(),5000);

		//搜索时间段
		laydate.render({
			elem: '#test1',
			type: 'datetime'
		});

		laydate.render({
			elem: '#test2'
			,type: 'datetime'
			,ready: function(date){
				$(".layui-laydate-footer [lay-type='datetime'].laydate-btns-time").click();
				$(".laydate-main-list-0 .layui-laydate-content li ol li:last-child").click();
				$(".layui-laydate-footer [lay-type='date'].laydate-btns-time").click();
			}
		});
		$(".tempdata_del").click(function(){
			var gw_id  = $("input[name='gw_id']").val();
			var sn_id  = $("input[name='sn_id']").val();
			var select_start_time  = $("#test1").val();
			var select_end_time  = $("#test2").val();
			 $.ajax({
	            url: "{:url('tempdata_del')}",
	            data: {gw_id, sn_id, select_start_time, select_end_time},
	            type: "get",
	            success: function (m) {
	          		if(m.code == '1'){
	          			alert('删除成功');
	          		}else{
	          			alert('error');
	          		}
	          		window.location.reload();
	            },
	            error: function () { alert("数据错误!"); },
	        });
		})
	</script>
</body>

</html>