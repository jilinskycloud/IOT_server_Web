<include file="public@header"/>
</head>
<body>
<div class="wrap js-check-wrap">
    <ul class="nav nav-tabs">
        <li class="active"><a href="">温度服务监测列表</a></li>
    </ul>
    <form class="well form-inline margin-top-20" method="post" action="{:url('Iot/iotlist')}">
        网关序列号:
        <input type="text" class="form-control" name="gw_id"  style="width: 150px;" placeholder="网关序列号">
        <input type="text" class="form-control" name="sn_id"  style="width: 150px;" placeholder="传感器ID">
        <input type="text" class="layui-input form-control" name="select_start_time" id="test1"  value="{:input('request.select_start_time/s','')}" placeholder="请选择开始时间" style=" width:300px" autocomplete="off">
        ~
      <input type="text" class="layui-input form-control" name="select_end_time" id="test2"  value="{:input('request.select_end_time/s','')}" placeholder="请选择结束时间" style=" width:300px" autocomplete="off">
        <input type="submit" id="search" class="btn btn-primary" value="搜索"/>
        <a class="btn btn-danger" href="{:url('Iot/iotlist')}">清空</a>
        <!--<a class="btn btn-warning" href="{:url('addSn')}">添加</a>-->
    </form>


    <table class="table table-hover table-bordered table-list">
        <thead>
        <tr>
            <th>网关序列号</th>
            <th>传感器ID</th>
            <th>服务类型</th>
            <th>发送网址</th>
            <th>数值</th>
            <th>发送时间</th>
            <th>操作</th>
        </tr>
        </thead>
        <tbody>
        <foreach name="data" item="vo">
            <tr>
                <td>{$vo.gw_id}</td>
                <td>{$vo['sn_id']} <?php 
                            $sn_describe = "   (未知)";
                            $sn_info = explode("-",$vo['sn_id']);
                            if(isset($sn_info[1])){
                                switch ($sn_info[1]){
                                    case '37':
                                      $sn_describe = "   (机舱内部)";
                                      break;  
                                    case 'F9':
                                       $sn_describe = "   (机舱外部)";
                                      break;
                                    case '3D':
                                       $sn_describe = "   (塔机内部)";
                                      break;
                                    case 'FD':
                                       $sn_describe = "   (塔机外部)";
                                      break;
                                    default:
                                      $sn_describe = "   (未知)";
                                }
                            }else{
                                if($vo['sn_id'] == '192.168.1.244:64000'){
                                    $sn_describe = "   (主轴外移)";
                                }
                            }
                            echo $sn_describe;
                        ?></td>
                <td>{$vo.ST}</td>
                <td>{$vo.ip}</td>
                <td>{$vo['temp']|sprintf='%1\$.4f',###}</td>
                <td><?php echo get_microtime_format($vo['create_time'] * 0.001); ?></td>
                <td>
                    <a class="btn btn-xs btn-primary" href="{:url('getGateConfig',['gw_id' => $vo.gw_id, 'sn_id' => $vo.sn_id])}">配 置</a>
                    <a class="btn btn-xs btn-primary" href="{:url('sendGateConfig',['gw_id' => $vo.gw_id, 'sn_id' => $vo.sn_id])}">发 送</a>
                    <a class="btn btn-xs btn-primary" href="{:url('tempCensus',['gw_id' => $vo.gw_id, 'sn_id' => $vo.sn_id])}">本日统计</a>
                    <a class="btn btn-xs btn-danger js-ajax-delete" href="{:url('delGateSn',['id' => $vo.id, 'gw_id' => $vo.gw_id, 'sn_id' => $vo.sn_id])}">删 除</a>
                </td>
            </tr>
        </foreach>
        </tbody>
    </table>
    <div class="footer">
        <div class="pagination">{$page|default=''}</div>
    </div>

</div>
<script src="__STATIC__/js/admin.js"></script>
<script src="__STATIC__/js/echarts.min.js"></script>
 <script type="text/javascript">
     //隔5秒刷新当前页面
     // setInterval(window.location.reload(),5000);

     //搜索时间段
     laydate.render({
        elem: '#test1',
        type: 'datetime'
    });

     laydate.render({
        elem: '#test2'
        ,type: 'datetime'
        ,ready: function(date){
        $(".layui-laydate-footer [lay-type='datetime'].laydate-btns-time").click();
        $(".laydate-main-list-0 .layui-laydate-content li ol li:last-child").click();
        $(".layui-laydate-footer [lay-type='date'].laydate-btns-time").click();
        }
        });

</script>


</body>
</html>