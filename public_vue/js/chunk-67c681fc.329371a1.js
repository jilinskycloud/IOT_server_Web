(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-67c681fc"],{"12d7":function(e,t,i){"use strict";i.r(t);var a=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"table"},[i("div",{staticClass:"crumbs"},[i("el-breadcrumb",{attrs:{separator:"/"}},[i("el-breadcrumb-item",[i("i",{staticClass:"el-icon-lx-cascades"}),e._v(" 管理员列表")])],1)],1),i("div",{staticClass:"container"},[i("div",{staticClass:"handle-box"},[i("el-button",{staticClass:"handle-del mr10",attrs:{type:"primary",icon:"delete"},on:{click:function(t){e.addVisible=!0}}},[e._v("添加管理员")]),i("el-input",{staticClass:"handle-input mr10",attrs:{placeholder:"筛选管理员名称"},model:{value:e.select_word,callback:function(t){e.select_word=t},expression:"select_word"}}),i("el-button",{attrs:{type:"primary",icon:"search"},on:{click:e.search}},[e._v("搜索")])],1),i("el-table",{ref:"multipleTable",staticClass:"table",attrs:{data:e.currentTableData,border:""},on:{"selection-change":e.handleSelectionChange}},[i("el-table-column",{attrs:{prop:"id",type:"selection",width:"55",align:"center",label:"ID"}}),i("el-table-column",{attrs:{prop:"user_login",label:"管理员名称",width:"160"}}),i("el-table-column",{attrs:{prop:"last_login_time",formatter:e.dateFormat,label:"最后登录时间"}}),i("el-table-column",{attrs:{prop:"last_login_ip",label:"最后登录ID"}}),i("el-table-column",{attrs:{prop:"user_status",label:"状态",width:"120"},scopedSlots:e._u([{key:"default",fn:function(t){return[0==t.row.user_status?i("el-tag",{attrs:{type:"danger","disable-transitions":""}},[e._v("禁用")]):1==t.row.user_status?i("el-tag",{attrs:{type:"success","disable-transitions":""}},[e._v("正常")]):2==t.row.user_status?i("el-tag",{attrs:{type:"warning","disable-transitions":""}},[e._v("未验证")]):e._e()]}}])}),i("el-table-column",{attrs:{label:"操作",width:"240",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("el-button",{attrs:{type:"text",icon:"el-icon-edit",disabled:1==t.row.id},on:{click:function(i){e.handleEdit(t.$index,t.row)}}},[e._v("编 辑")]),i("el-button",{staticClass:"red",attrs:{type:"text",icon:"el-icon-delete",disabled:1==t.row.id},on:{click:function(i){e.handleDelete(t.$index,t.row)}}},[e._v("删 除")])]}}])})],1),i("div",{staticClass:"pagination"},[i("el-pagination",{attrs:{background:"","current-page":e.cur_page,"page-size":e.pageSize,layout:"prev, pager, next",total:e.totalCount},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1)],1),i("el-dialog",{directives:[{name:"dialogDrag",rawName:"v-dialogDrag"}],attrs:{title:"添加",visible:e.addVisible,width:"30%"},on:{"update:visible":function(t){e.addVisible=t}}},[i("el-form",{ref:"form_add",attrs:{model:e.form_add,"label-width":"100px"}},[i("el-form-item",{attrs:{label:"管理员名称",required:!0}},[i("el-input",{model:{value:e.form_add.user_login,callback:function(t){e.$set(e.form_add,"user_login",t)},expression:"form_add.user_login"}})],1),i("el-form-item",{attrs:{label:"密码",required:!0}},[i("el-input",{attrs:{type:"password"},model:{value:e.form_add.user_pass,callback:function(t){e.$set(e.form_add,"user_pass",t)},expression:"form_add.user_pass"}})],1),i("el-form-item",{attrs:{label:"邮箱"}},[i("el-input",{model:{value:e.form_add.user_email,callback:function(t){e.$set(e.form_add,"user_email",t)},expression:"form_add.user_email"}})],1),i("el-form-item",{attrs:{label:"个人网址"}},[i("el-input",{model:{value:e.form_add.user_url,callback:function(t){e.$set(e.form_add,"user_url",t)},expression:"form_add.user_url"}})],1),i("el-form-item",{attrs:{label:"角色",required:!0}},[i("div",e._l(e.roles,function(t){return i("el-radio-group",{attrs:{size:"small"},model:{value:e.form_add.role_id,callback:function(t){e.$set(e.form_add,"role_id",t)},expression:"form_add.role_id"}},[i("el-radio",{staticStyle:{margin:"5px"},attrs:{label:t.id,border:""}},[e._v(e._s(t.name))])],1)}),1)])],1),i("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{on:{click:function(t){e.addVisible=!1}}},[e._v("取 消")]),i("el-button",{attrs:{type:"primary"},on:{click:e.saveAdd}},[e._v("确 定")])],1)],1),i("el-dialog",{directives:[{name:"dialogDrag",rawName:"v-dialogDrag"}],attrs:{title:"编辑",visible:e.editVisible,width:"40%"},on:{"update:visible":function(t){e.editVisible=t}}},[i("el-form",{ref:"form_edit",attrs:{model:e.form_edit,"label-width":"100px"}},[i("el-form-item",{attrs:{label:"管理员名称"}},[i("el-input",{model:{value:e.form_edit.user_login,callback:function(t){e.$set(e.form_edit,"user_login",t)},expression:"form_edit.user_login"}})],1),i("el-form-item",{attrs:{label:"状态"}},[i("el-switch",{attrs:{"active-value":1,"inactive-value":0,"active-text":"启用","inactive-text":"禁用","active-color":"#13ce66","inactive-color":"#ff4949"},model:{value:e.form_edit.user_status,callback:function(t){e.$set(e.form_edit,"user_status",t)},expression:"form_edit.user_status"}})],1),i("el-form-item",{attrs:{label:"角色"}},[i("div",e._l(e.roles,function(t){return i("el-radio-group",{attrs:{size:"small"},model:{value:e.form_edit.role_id,callback:function(t){e.$set(e.form_edit,"role_id",t)},expression:"form_edit.role_id"}},[i("el-radio",{staticStyle:{margin:"5px"},attrs:{label:t.id,border:""}},[e._v(e._s(t.name))])],1)}),1)]),i("el-input",{attrs:{type:"hidden"},model:{value:e.form_edit.last_login_time,callback:function(t){e.$set(e.form_edit,"last_login_time",t)},expression:"form_edit.last_login_time"}}),i("el-input",{attrs:{type:"hidden"},model:{value:e.form_edit.last_login_ip,callback:function(t){e.$set(e.form_edit,"last_login_ip",t)},expression:"form_edit.last_login_ip"}}),i("el-input",{attrs:{type:"hidden"},model:{value:e.form_edit.id,callback:function(t){e.$set(e.form_edit,"id",t)},expression:"form_edit.id"}})],1),i("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{on:{click:function(t){e.editVisible=!1}}},[e._v("取 消")]),i("el-button",{attrs:{type:"primary"},on:{click:e.saveEdit}},[e._v("确 定")])],1)],1),i("el-dialog",{attrs:{title:"提示",visible:e.delVisible,width:"300px",center:""},on:{"update:visible":function(t){e.delVisible=t}}},[i("div",{staticClass:"del-dialog-cnt"},[e._v("删除不可恢复，是否确定删除？")]),i("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{on:{click:function(t){e.delVisible=!1}}},[e._v("取 消")]),i("el-button",{attrs:{type:"primary"},on:{click:e.deleteRow}},[e._v("确 定")])],1)])],1)},s=[],l=(i("7f7f"),i("57e7"),i("ac6a"),i("f3e2"),i("4ec3"),i("c466")),r={name:"user",data:function(){return{tableData:[],currentTableData:[],filtercurrentTableData:[],totalCount:0,pageSize:10,cur_page:1,multipleSelection:[],select_cate:"",select_word:"",del_list:[],is_search:!1,addVisible:!1,roles:[],defaultProps:{children:"subs",label:"title"},editVisible:!1,delVisible:!1,form_add:{user_login:"",user_pass:"",user_email:"",user_url:"",user_type:"",role_id:""},form_edit:{id:"",user_login:"",user_status:"",last_login_time:"",last_login_ip:"",role_id:""},idx:-1}},created:function(){this.getUserlist()},computed:{},methods:{dateFormat:function(e,t){var i=e.last_login_time;return void 0==i?"":Object(l["a"])(new Date(1e3*i),"yyyy-MM-dd hh:mm")},getUserlist:function(){var e=this;this.$api.user.getUserlist().then(function(t){if(200!=t.code)e.$message({message:"获取管理员列表失败",type:"error",center:!0,duration:1e3});else if(e.tableData=t.data.list,e.roles=t.data.roles,e.totalCount=e.tableData.length,e.totalCount>e.pageSize)for(var i=0;i<e.pageSize;i++)e.currentTableData.push(e.tableData[i]);else e.currentTableData=e.tableData}).catch(function(e){console.log(e)})},search:function(){var e=this;if(""!=this.select_word||1!=this.is_search)""!=this.select_word||0!=this.is_search?(this.currentTableData=[],this.filtercurrentTableData=[],this.tableData.forEach(function(t,i){t.user_login&&t.user_login.indexOf(e.select_word)>=0&&e.filtercurrentTableData.push(t)}),this.cur_page=1,this.totalCount=this.filtercurrentTableData.length,this.currentChangePage(this.filtercurrentTableData),this.is_search=!0):this.$message.warning("查询条件不能为空！");else if(this.is_search=!1,this.currentTableData=[],this.totalCount=this.tableData.length,this.totalCount>this.pageSize)for(var t=0;t<this.pageSize;t++)this.currentTableData.push(this.tableData[t]);else this.currentTableData=this.tableData},handleSizeChange:function(e){this.pageSize=e,this.handleCurrentChange(this.cur_page)},handleCurrentChange:function(e){console.log("当前页: ".concat(e)),this.cur_page=e,this.is_search?this.currentChangePage(this.filtercurrentTableData):this.currentChangePage(this.tableData)},currentChangePage:function(e){var t=(this.cur_page-1)*this.pageSize,i=this.cur_page*this.pageSize;for(this.currentTableData=[];t<i;t++)e[t]&&this.currentTableData.push(e[t])},handleEdit:function(e,t){this.idx=e;var i=this.currentTableData[e];this.form_edit={id:i.id,user_login:i.user_login,user_status:i.user_status,last_login_time:i.last_login_time,last_login_ip:i.last_login_ip,role_id:i.role_id},this.editVisible=!0},handleDelete:function(e,t){this.idx=e,this.delVisible=!0},delAll:function(){var e=this.multipleSelection.length,t="";this.del_list=this.del_list.concat(this.multipleSelection);for(var i=0;i<e;i++)t+=this.multipleSelection[i].name+" ";this.$message.error("删除了"+t),this.multipleSelection=[]},handleSelectionChange:function(e){this.multipleSelection=e},saveEdit:function(){var e=this;if(""!=this.form_edit.user_login)if(""!=this.form_edit.role_id){this.$set(this.currentTableData,this.idx,this.form_edit);var t={id:this.form_edit.id,user_login:this.form_edit.user_login,user_status:this.form_edit.user_status,user_role:this.form_edit.role_id,user_type:1};this.$api.user.editUser(t).then(function(t){200!=t.code&&e.$message.error("编辑管理员失败"),e.editVisible=!1,e.$message.success("编辑管理员成功")})}else this.$message.warning("管理员必须选择角色");else this.$message.warning("管理员名称不能为空")},deleteRow:function(){var e=this,t=this.currentTableData[this.idx].id,i={id:t};this.$api.user.del(i).then(function(t){200!=t.code&&e.$message.error("修改第 ".concat(e.idx+1," 行失败")),e.tableData.splice(e.idx,1),e.delVisible=!1,e.$message.success("删除成功")}).catch(function(e){console.log(e)})},saveAdd:function(){var e=this;""!=this.form_add.user_login?""!=this.form_add.user_pass?""!=this.form_add.role_id?(this.form_add.user_type=1,this.$api.user.addUser(this.form_add).then(function(t){if(200!=t.code)return e.$message.error("添加管理员失败"),void(e.addVisible=!1);e.tableData.push(t.data),e.addVisible=!1,e.$message.success("添加角色成功")}).catch(function(e){console.log(e)})):this.$message.warning("管理员角色不能为空"):this.$message.warning("管理员密码不能为空"):this.$message.warning("管理员名称不能为空")}}},o=r,n=(i("aec1"),i("2877")),d=Object(n["a"])(o,a,s,!1,null,null,null);d.options.__file="User.vue";t["default"]=d.exports},"484e":function(e,t,i){},aec1:function(e,t,i){"use strict";var a=i("484e"),s=i.n(a);s.a},c466:function(e,t,i){"use strict";i.d(t,"a",function(){return a});i("3b2b"),i("a481");function a(e,t){/(y+)/.test(t)&&(t=t.replace(RegExp.$1,(e.getFullYear()+"").substr(4-RegExp.$1.length)));var i={"M+":e.getMonth()+1,"d+":e.getDate(),"h+":e.getHours(),"m+":e.getMinutes(),"s+":e.getSeconds()};for(var a in i)if(new RegExp("(".concat(a,")")).test(t)){var l=i[a]+"";t=t.replace(RegExp.$1,1===RegExp.$1.length?l:s(l))}return t}function s(e){return("00"+e).substr(e.length)}}}]);