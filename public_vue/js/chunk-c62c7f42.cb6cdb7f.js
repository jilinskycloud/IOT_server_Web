(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-c62c7f42"],{"0119":function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"table"},[a("div",{staticClass:"crumbs"},[a("el-breadcrumb",{attrs:{separator:"/"}},[a("el-breadcrumb-item",[a("i",{staticClass:"el-icon-lx-cascades"}),e._v(" 温度监测")])],1)],1),a("div",{staticClass:"container"},[a("div",{staticClass:"handle-box"},[a("el-input",{staticClass:"handle-input mr10",attrs:{placeholder:"筛选网关序号"},model:{value:e.select_word,callback:function(t){e.select_word=t},expression:"select_word"}}),a("el-button",{attrs:{type:"primary",icon:"search"},on:{click:e.search}},[e._v("搜索")])],1),a("el-table",{ref:"multipleTable",staticClass:"table",attrs:{data:e.currentTableData,border:""},on:{"selection-change":e.handleSelectionChange}},[a("el-table-column",{attrs:{prop:"id",type:"selection",width:"55",align:"center",label:"ID"}}),a("el-table-column",{attrs:{prop:"gw_id",label:"网关序列号",width:"160"}}),a("el-table-column",{attrs:{prop:"sn_id",label:"传感器ID"}}),a("el-table-column",{attrs:{prop:"ST",label:"服务类型"}}),a("el-table-column",{attrs:{prop:"ip",label:"发送网址"}}),a("el-table-column",{attrs:{prop:"temp",label:"温度"}}),a("el-table-column",{attrs:{prop:"date",label:"发送时间"}}),a("el-table-column",{attrs:{label:"操作",width:"240",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"text",icon:"el-icon-"},on:{click:function(a){e.handleConfig(t.$index,t.row)}}},[e._v("配 置")]),a("el-button",{attrs:{type:"text",icon:"el-icon-"},on:{click:function(a){e.beforeSendConfig(t.$index,t.row)}}},[e._v("发 送")]),a("el-button",{attrs:{type:"text",icon:"el-icon-"},on:{click:function(a){e.censusTemp(t.$index,t.row)}}},[e._v("统 计")])]}}])})],1),a("div",{staticClass:"pagination"},[a("el-pagination",{attrs:{background:"","current-page":e.cur_page,"page-size":e.pageSize,layout:"prev, pager, next",total:e.totalCount},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1)],1),a("el-dialog",{directives:[{name:"dialogDrag",rawName:"v-dialogDrag"}],attrs:{title:"配置",visible:e.configVisible,width:"40%"},on:{"update:visible":function(t){e.configVisible=t}}},[a("el-form",{ref:"form_config",attrs:{model:e.form_config,"label-width":"150px"}},[a("el-form-item",{attrs:{label:"发送时间间隔",required:!0}},[a("el-input",{model:{value:e.form_config.s_time,callback:function(t){e.$set(e.form_config,"s_time",t)},expression:"form_config.s_time"}})],1),a("el-form-item",{attrs:{label:"心跳API地址",required:!0}},[a("el-input",{model:{value:e.form_config.hb_api_address,callback:function(t){e.$set(e.form_config,"hb_api_address",t)},expression:"form_config.hb_api_address"}})],1),a("el-form-item",{attrs:{label:"DataAPI地址",required:!0}},[a("el-input",{model:{value:e.form_config.data_api_address,callback:function(t){e.$set(e.form_config,"data_api_address",t)},expression:"form_config.data_api_address"}})],1),a("el-form-item",{attrs:{label:"固定重启时间",required:!0}},[a("el-input",{model:{value:e.form_config.data_reboot_time,callback:function(t){e.$set(e.form_config,"data_reboot_time",t)},expression:"form_config.data_reboot_time"}})],1),a("el-form-item",{attrs:{label:"心跳发送间隔时间",required:!0}},[a("el-input",{model:{value:e.form_config.hb_interval,callback:function(t){e.$set(e.form_config,"hb_interval",t)},expression:"form_config.hb_interval"}})],1),a("el-form-item",{attrs:{label:"Data发送间隔时间",required:!0}},[a("el-input",{model:{value:e.form_config.data_interval,callback:function(t){e.$set(e.form_config,"data_interval",t)},expression:"form_config.data_interval"}})],1),a("el-form-item",{attrs:{label:"版本",required:!0}},[a("el-input",{model:{value:e.form_config.version,callback:function(t){e.$set(e.form_config,"version",t)},expression:"form_config.version"}})],1),a("el-input",{attrs:{type:"hidden"},model:{value:e.form_config.gw_id,callback:function(t){e.$set(e.form_config,"gw_id",t)},expression:"form_config.gw_id"}}),a("el-input",{attrs:{type:"hidden"},model:{value:e.form_config.sn_id,callback:function(t){e.$set(e.form_config,"sn_id",t)},expression:"form_config.sn_id"}})],1),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.configVisible=!1}}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:e.saveConfig}},[e._v("保 存")])],1)],1),a("el-dialog",{directives:[{name:"dialogDrag",rawName:"v-dialogDrag"}],attrs:{title:"温度统计",visible:e.tempVisible,customClass:"customWidth"}},[a("el-col",{attrs:{width:"100%",height:"100%"}},[a("el-card",{attrs:{shadow:"hover"}},[a("schart",{ref:"line",staticClass:"schart",attrs:{canvasId:"line",data:e.temp_data,type:"line",options:e.options}})],1)],1),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.tempVisible=!1}}},[e._v("取 消")])],1)],1),a("el-dialog",{attrs:{title:"提示",visible:e.sendVisible,width:"300px",center:""},on:{"update:visible":function(t){e.sendVisible=t}}},[a("div",{staticClass:"del-dialog-cnt"},[e._v("确认发送吗？")]),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.sendVisible=!1}}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:e.sendConfig}},[e._v("确 定")])],1)])],1)},s=[],n=(a("7f7f"),a("57e7"),a("ac6a"),a("f3e2"),a("cadf"),a("551c"),a("097d"),a("4ec3"),a("c466")),o=a("f5ac"),r=(a("313e"),a("7ed4"),{name:"temperature",data:function(){return{tableData:[],currentTableData:[],filtercurrentTableData:[],totalCount:0,pageSize:10,cur_page:1,temp_data:[],multipleSelection:[],select_cate:"",select_word:"",del_list:[],is_search:!1,tempVisible:!1,sendVisible:!1,roles:[],defaultProps:{children:"subs",label:"title"},configVisible:!1,delVisible:!1,form_add:{user_login:"",user_pass:"",user_email:"",user_url:"",user_type:"",role_id:""},form_config:{gw_id:"",sn_id:"",s_time:"",hb_api_address:"",data_api_address:"",data_reboot_time:"",hb_interval:"",data_interval:"",version:""},idx:-1,options:{title:"温度最新变化曲线",fillColor:"#FC6FA1",axisColor:"#008ACD",contentColor:"#EEEEEE",bgColor:"#F5F8FD",bottomPadding:60,topPadding:60}}},components:{Schart:o["a"]},mounted:function(){this.getiotlist(),setInterval(this.getiotlist,6e4)},computed:{},methods:{dateFormat:function(e,t){var a=e.s_time;return void 0==a?"":Object(n["a"])(new Date(1e3*a),"yyyy-MM-dd hh:mm")},getiotlist:function(){var e=this;this.$api.iot.getIotlist().then(function(t){if(200!=t.code)e.$message({message:"获取管理员列表失败",type:"error",center:!0,duration:1e3});else if(e.tableData=t.data.list,e.roles=t.data.roles,e.totalCount=e.tableData.length,e.totalCount>e.pageSize)for(var a=0;a<e.pageSize;a++)e.currentTableData.push(e.tableData[a]);else e.currentTableData=e.tableData}).catch(function(e){console.log(e)})},search:function(){var e=this;if(""!=this.select_word||1!=this.is_search)""!=this.select_word||0!=this.is_search?(this.currentTableData=[],this.filtercurrentTableData=[],this.tableData.forEach(function(t,a){t.gw_id&&t.gw_id.indexOf(e.select_word)>=0&&e.filtercurrentTableData.push(t)}),this.cur_page=1,this.totalCount=this.filtercurrentTableData.length,this.currentChangePage(this.filtercurrentTableData),this.is_search=!0):this.$message.warning("查询条件不能为空！");else if(this.is_search=!1,this.currentTableData=[],this.totalCount=this.tableData.length,this.totalCount>this.pageSize)for(var t=0;t<this.pageSize;t++)this.currentTableData.push(this.tableData[t]);else this.currentTableData=this.tableData},handleSizeChange:function(e){this.pageSize=e,this.handleCurrentChange(this.cur_page)},handleCurrentChange:function(e){console.log("当前页: ".concat(e)),this.cur_page=e,this.is_search?this.currentChangePage(this.filtercurrentTableData):this.currentChangePage(this.tableData)},currentChangePage:function(e){var t=(this.cur_page-1)*this.pageSize,a=this.cur_page*this.pageSize;for(this.currentTableData=[];t<a;t++)e[t]&&this.currentTableData.push(e[t])},handleConfig:function(e,t){var a=this;this.idx=e;var i=this.currentTableData[e],s=this.form_config={gw_id:i.gw_id,sn_id:i.sn_id};this.$api.iot.getGateConfig(s).then(function(e){if(console.log(e),"empty"==e.msg)return a.form_config={gw_id:e.data.gw_id,sn_id:e.data.sn_id},void(a.configVisible=!0);a.form_config={gw_id:e.data.gw_id,sn_id:e.data.sn_id,s_time:e.data.s_time,hb_api_address:e.data.hb_api_address,data_api_address:e.data.data_api_address,data_reboot_time:e.data.data_reboot_time,hb_interval:e.data.hb_interval,data_interval:e.data.data_interval,version:e.data.version},a.configVisible=!0})},beforeSendConfig:function(e,t){this.idx=e,this.sendVisible=!0},sendConfig:function(){var e=this,t=this.idx,a=this.currentTableData[t],i={gw_id:a.gw_id,sn_id:a.sn_id};this.$api.iot.sendGateConfig(i).then(function(t){e.sendVisible=!1,e.$message.success("发送配置成功，请等待")})},censusTemp:function(e,t){var a=this;this.idx=e;var i=this.currentTableData[e],s={gw_id:i.gw_id,sn_id:i.sn_id};this.tempVisible=!0,this.$api.iot.tempCensus(s).then(function(e){a.temp_data=e.data})},saveConfig:function(){var e=this;""!=this.form_config.s_time?""!=this.form_config.hb_api_address?""!=this.form_config.data_api_address?""!=this.form_config.data_reboot_time?""!=this.form_config.hb_interval?""!=this.form_config.data_interval?""!=this.form_config.version?this.$api.iot.setGateConfig(this.form_config).then(function(t){200!=t.code&&e.$message.error("保存配置失败！"),e.configVisible=!1,e.$message.success("保存配置成功")}):this.$message.warning("version不能为空"):this.$message.warning("data_interval不能为空"):this.$message.warning("hb_interval不能为空"):this.$message.warning("data_reboot_time不能为空"):this.$message.warning("data_api_address不能为空"):this.$message.warning("hb_api_address不能为空"):this.$message.warning("s_time不能为空")},delAll:function(){var e=this.multipleSelection.length,t="";this.del_list=this.del_list.concat(this.multipleSelection);for(var a=0;a<e;a++)t+=this.multipleSelection[a].name+" ";this.$message.error("删除了"+t),this.multipleSelection=[]},handleSelectionChange:function(e){this.multipleSelection=e},saveAdd:function(){var e=this;""!=this.form_add.user_login?""!=this.form_add.user_pass?""!=this.form_add.role_id?(this.form_add.user_type=1,this.$api.user.addUser(this.form_add).then(function(t){if(200!=t.code)return e.$message.error("添加管理员失败"),void(e.addVisible=!1);e.tableData.push(t.data),e.addVisible=!1,e.$message.success("添加角色成功")}).catch(function(e){console.log(e)})):this.$message.warning("管理员角色不能为空"):this.$message.warning("管理员密码不能为空"):this.$message.warning("管理员名称不能为空")}}}),l=r,c=(a("eb20"),a("2877")),d=Object(c["a"])(l,i,s,!1,null,null,null);d.options.__file="Temperature.vue";t["default"]=d.exports},"8a36":function(e,t,a){},c466:function(e,t,a){"use strict";a.d(t,"a",function(){return i});a("3b2b"),a("a481");function i(e,t){/(y+)/.test(t)&&(t=t.replace(RegExp.$1,(e.getFullYear()+"").substr(4-RegExp.$1.length)));var a={"M+":e.getMonth()+1,"d+":e.getDate(),"h+":e.getHours(),"m+":e.getMinutes(),"s+":e.getSeconds()};for(var i in a)if(new RegExp("(".concat(i,")")).test(t)){var n=a[i]+"";t=t.replace(RegExp.$1,1===RegExp.$1.length?n:s(n))}return t}function s(e){return("00"+e).substr(e.length)}},eb20:function(e,t,a){"use strict";var i=a("8a36"),s=a.n(i);s.a}}]);