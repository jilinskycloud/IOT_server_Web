(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-04cd3ed6"],{"0d61":function(e,t,a){"use strict";var i=a("25ea"),s=a.n(i);s.a},"25ea":function(e,t,a){},c466:function(e,t,a){"use strict";a.d(t,"a",function(){return i});a("3b2b"),a("a481");function i(e,t){/(y+)/.test(t)&&(t=t.replace(RegExp.$1,(e.getFullYear()+"").substr(4-RegExp.$1.length)));var a={"M+":e.getMonth()+1,"d+":e.getDate(),"h+":e.getHours(),"m+":e.getMinutes(),"s+":e.getSeconds()};for(var i in a)if(new RegExp("(".concat(i,")")).test(t)){var r=a[i]+"";t=t.replace(RegExp.$1,1===RegExp.$1.length?r:s(r))}return t}function s(e){return("00"+e).substr(e.length)}},ed68:function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"table"},[a("div",{staticClass:"crumbs"},[a("el-breadcrumb",{attrs:{separator:"/"}},[a("el-breadcrumb-item",[a("i",{staticClass:"el-icon-lx-cascades"}),e._v(" 网关列表")])],1)],1),a("div",{staticClass:"container"},[a("div",{staticClass:"handle-box"},[a("el-input",{staticClass:"handle-input mr10",attrs:{placeholder:"筛选网关序号"},model:{value:e.select_word,callback:function(t){e.select_word=t},expression:"select_word"}}),a("el-button",{attrs:{type:"primary",icon:"search"},on:{click:e.search}},[e._v("搜索")])],1),a("el-table",{ref:"multipleTable",staticClass:"table",attrs:{data:e.currentTableData,border:""},on:{"selection-change":e.handleSelectionChange}},[a("el-table-column",{attrs:{prop:"id",type:"selection",width:"55",align:"center",label:"ID"}}),a("el-table-column",{attrs:{prop:"gw_id",label:"电子板序列号",width:"160"}}),a("el-table-column",{attrs:{prop:"s_time",formatter:e.dateFormat,label:"发送时间"}}),a("el-table-column",{attrs:{prop:"sn_id",label:"温度监视器ID"}}),a("el-table-column",{attrs:{prop:"ST",label:"服务类型"}}),a("el-table-column",{attrs:{prop:"temp",label:"温度",width:"120"}})],1),a("div",{staticClass:"pagination"},[a("el-pagination",{attrs:{background:"","current-page":e.cur_page,"page-size":e.pageSize,layout:"prev, pager, next",total:e.totalCount},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1)],1)])},s=[],r=(a("7f7f"),a("57e7"),a("ac6a"),a("f3e2"),a("4ec3"),a("c466")),l={name:"user",data:function(){return{tableData:[],currentTableData:[],filtercurrentTableData:[],totalCount:0,pageSize:10,cur_page:1,multipleSelection:[],select_cate:"",select_word:"",del_list:[],is_search:!1,addVisible:!1,roles:[],defaultProps:{children:"subs",label:"title"},editVisible:!1,delVisible:!1,form_add:{user_login:"",user_pass:"",user_email:"",user_url:"",user_type:"",role_id:""},form_edit:{id:"",user_login:"",user_status:"",last_login_time:"",last_login_ip:"",role_id:""},idx:-1}},created:function(){this.getiotlist()},computed:{},methods:{dateFormat:function(e,t){var a=e.s_time;return void 0==a?"":Object(r["a"])(new Date(1e3*a),"yyyy-MM-dd hh:mm")},hbStatus:function(e,t){var a=t.hb_time,i=(new Date).getTime();console.log("hb_time:"+a),console.log("timestamp:"+i);var s=i-a;return console.log("res:"+s),s>=6e5?"失效":"正常"},getiotlist:function(){var e=this;this.$api.iot.getIotlist().then(function(t){if(200!=t.code)e.$message({message:"获取管理员列表失败",type:"error",center:!0,duration:1e3});else if(e.tableData=t.data.list,e.roles=t.data.roles,e.totalCount=e.tableData.length,e.totalCount>e.pageSize)for(var a=0;a<e.pageSize;a++)e.currentTableData.push(e.tableData[a]);else e.currentTableData=e.tableData}).catch(function(e){console.log(e)})},search:function(){var e=this;if(""!=this.select_word||1!=this.is_search)""!=this.select_word||0!=this.is_search?(this.currentTableData=[],this.filtercurrentTableData=[],this.tableData.forEach(function(t,a){t.gw_id&&t.gw_id.indexOf(e.select_word)>=0&&e.filtercurrentTableData.push(t)}),this.cur_page=1,this.totalCount=this.filtercurrentTableData.length,this.currentChangePage(this.filtercurrentTableData),this.is_search=!0):this.$message.warning("查询条件不能为空！");else if(this.is_search=!1,this.currentTableData=[],this.totalCount=this.tableData.length,this.totalCount>this.pageSize)for(var t=0;t<this.pageSize;t++)this.currentTableData.push(this.tableData[t]);else this.currentTableData=this.tableData},handleSizeChange:function(e){this.pageSize=e,this.handleCurrentChange(this.cur_page)},handleCurrentChange:function(e){console.log("当前页: ".concat(e)),this.cur_page=e,this.is_search?this.currentChangePage(this.filtercurrentTableData):this.currentChangePage(this.tableData)},currentChangePage:function(e){var t=(this.cur_page-1)*this.pageSize,a=this.cur_page*this.pageSize;for(this.currentTableData=[];t<a;t++)e[t]&&this.currentTableData.push(e[t])},handleEdit:function(e,t){this.idx=e;var a=this.currentTableData[e];this.form_edit={id:a.id,user_login:a.user_login,user_status:a.user_status,last_login_time:a.last_login_time,last_login_ip:a.last_login_ip,role_id:a.role_id},this.editVisible=!0},delAll:function(){var e=this.multipleSelection.length,t="";this.del_list=this.del_list.concat(this.multipleSelection);for(var a=0;a<e;a++)t+=this.multipleSelection[a].name+" ";this.$message.error("删除了"+t),this.multipleSelection=[]},handleSelectionChange:function(e){this.multipleSelection=e},saveEdit:function(){var e=this;if(""!=this.form_edit.user_login)if(""!=this.form_edit.role_id){this.$set(this.currentTableData,this.idx,this.form_edit);var t={id:this.form_edit.id,user_login:this.form_edit.user_login,user_status:this.form_edit.user_status,user_role:this.form_edit.role_id,user_type:1};this.$api.user.editUser(t).then(function(t){200!=t.code&&e.$message.error("编辑管理员失败"),e.editVisible=!1,e.$message.success("编辑管理员成功")})}else this.$message.warning("管理员必须选择角色");else this.$message.warning("管理员名称不能为空")},saveAdd:function(){var e=this;""!=this.form_add.user_login?""!=this.form_add.user_pass?""!=this.form_add.role_id?(this.form_add.user_type=1,this.$api.user.addUser(this.form_add).then(function(t){if(200!=t.code)return e.$message.error("添加管理员失败"),void(e.addVisible=!1);e.tableData.push(t.data),e.addVisible=!1,e.$message.success("添加角色成功")}).catch(function(e){console.log(e)})):this.$message.warning("管理员角色不能为空"):this.$message.warning("管理员密码不能为空"):this.$message.warning("管理员名称不能为空")}}},n=l,o=(a("0d61"),a("2877")),c=Object(o["a"])(n,i,s,!1,null,null,null);c.options.__file="Iot.vue";t["default"]=c.exports}}]);